using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using System.Windows.Input;

namespace CustomSearchSpotlight
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
            // Ustawienia, aby okno pojawiało się na środku ekranu
            Left = (SystemParameters.PrimaryScreenWidth - Width) / 2;
            Top = (SystemParameters.PrimaryScreenHeight - Height) / 4;
            SearchTextBox.Focus();
        }

        private void Window_Deactivated(object sender, EventArgs e)
        {
            // Chowanie okna, gdy straci focus (jak wyszukiwarka Windows)
            Hide();
        }

        private void SearchTextBox_TextChanged(object sender, System.Windows.Controls.TextChangedEventArgs e)
        {
            // Tutaj będzie logika wyszukiwania
            var query = SearchTextBox.Text;
            if (string.IsNullOrWhiteSpace(query))
            {
                ResultsListBox.ItemsSource = null;
                return;
            }

            // Tymczasowo: wyświetlanie przykładowych wyników
            var results = new List<string>
            {
                $"Wynik 1 dla: {query}",
                $"Wynik 2 dla: {query}",
                $"Wynik 3 dla: {query}"
            };

            ResultsListBox.ItemsSource = results;
        }

        private void SearchTextBox_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Escape)
            {
                Hide();
            }
            else if (e.Key == Key.Enter)
            {
                // Obsługa wyboru pierwszego wyniku
                if (ResultsListBox.Items.Count > 0)
                {
                    ResultsListBox.SelectedIndex = 0;
                    // Tutaj uruchom wybrany wynik
                }
            }
            else if (e.Key == Key.Down)
            {
                ResultsListBox.Focus();
                if (ResultsListBox.Items.Count > 0)
                    ResultsListBox.SelectedIndex = 0;
                e.Handled = true;
            }
        }
    }
}
